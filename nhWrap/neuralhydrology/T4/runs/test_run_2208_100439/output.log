2024-08-22 10:04:39,364: Logging to S:\hydrolab\home\Omri_Porat\PhD\Python\neuralhydrology-neuralhydrology-e4329c3\neuralhydrology\T4\runs\test_run_2208_100439\output.log initialized.
2024-08-22 10:04:39,365: ### Folder structure created at S:\hydrolab\home\Omri_Porat\PhD\Python\neuralhydrology-neuralhydrology-e4329c3\neuralhydrology\T4\runs\test_run_2208_100439
2024-08-22 10:04:39,367: ### Run configurations for test_run
2024-08-22 10:04:39,367: experiment_name: test_run
2024-08-22 10:04:39,368: use_frequencies: ['1H', '1D']
2024-08-22 10:04:39,369: train_basin_file: 1_basin.txt
2024-08-22 10:04:39,369: validation_basin_file: 1_basin.txt
2024-08-22 10:04:39,370: test_basin_file: 1_basin.txt
2024-08-22 10:04:39,371: train_start_date: 1999-10-01 00:00:00
2024-08-22 10:04:39,371: train_end_date: 2008-09-30 00:00:00
2024-08-22 10:04:39,372: validation_start_date: 1996-10-01 00:00:00
2024-08-22 10:04:39,373: validation_end_date: 1999-09-30 00:00:00
2024-08-22 10:04:39,374: test_start_date: 1989-10-01 00:00:00
2024-08-22 10:04:39,374: test_end_date: 1996-09-30 00:00:00
2024-08-22 10:04:39,375: device: cpu
2024-08-22 10:04:39,376: validate_every: 5
2024-08-22 10:04:39,376: validate_n_random_basins: 1
2024-08-22 10:04:39,377: metrics: ['NSE']
2024-08-22 10:04:39,378: model: mtslstm
2024-08-22 10:04:39,378: shared_mtslstm: False
2024-08-22 10:04:39,379: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2024-08-22 10:04:39,380: head: regression
2024-08-22 10:04:39,381: output_activation: linear
2024-08-22 10:04:39,381: hidden_size: 20
2024-08-22 10:04:39,382: initial_forget_bias: 3
2024-08-22 10:04:39,383: output_dropout: 0.4
2024-08-22 10:04:39,384: optimizer: Adam
2024-08-22 10:04:39,385: loss: MSE
2024-08-22 10:04:39,385: regularization: ['tie_frequencies']
2024-08-22 10:04:39,386: learning_rate: {0: 0.01, 30: 0.005, 40: 0.001}
2024-08-22 10:04:39,387: batch_size: 256
2024-08-22 10:04:39,388: epochs: 50
2024-08-22 10:04:39,388: clip_gradient_norm: 1
2024-08-22 10:04:39,389: predict_last_n: {'1D': 1, '1H': 24}
2024-08-22 10:04:39,389: seq_length: {'1D': 365, '1H': 336}
2024-08-22 10:04:39,390: num_workers: 0
2024-08-22 10:04:39,391: log_interval: 5
2024-08-22 10:04:39,392: log_tensorboard: False
2024-08-22 10:04:39,392: log_n_figures: 0
2024-08-22 10:04:39,393: save_weights_every: 1
2024-08-22 10:04:39,394: dataset: hourly_camels_us
2024-08-22 10:04:39,396: data_dir: ..\..\..\..\data\CAMELS_US
2024-08-22 10:04:39,397: forcings: ['nldas_hourly', 'daymet']
2024-08-22 10:04:39,397: dynamic_inputs: {'1D': ['prcp(mm/day)_daymet', 'srad(W/m2)_daymet', 'tmax(C)_daymet', 'tmin(C)_daymet', 'vp(Pa)_daymet'], '1H': ['convective_fraction_nldas_hourly', 'longwave_radiation_nldas_hourly', 'potential_energy_nldas_hourly', 'potential_evaporation_nldas_hourly', 'pressure_nldas_hourly', 'shortwave_radiation_nldas_hourly', 'specific_humidity_nldas_hourly', 'temperature_nldas_hourly', 'total_precipitation_nldas_hourly', 'wind_u_nldas_hourly', 'wind_v_nldas_hourly', 'prcp(mm/day)_daymet', 'srad(W/m2)_daymet', 'tmax(C)_daymet', 'tmin(C)_daymet', 'vp(Pa)_daymet']}
2024-08-22 10:04:39,398: target_variables: ['qobs_mm_per_hour']
2024-08-22 10:04:39,399: clip_targets_to_zero: ['qobs_mm_per_hour']
2024-08-22 10:04:39,400: number_of_basins: 1
2024-08-22 10:04:39,400: run_dir: S:\hydrolab\home\Omri_Porat\PhD\Python\neuralhydrology-neuralhydrology-e4329c3\neuralhydrology\T4\runs\test_run_2208_100439
2024-08-22 10:04:39,401: train_dir: S:\hydrolab\home\Omri_Porat\PhD\Python\neuralhydrology-neuralhydrology-e4329c3\neuralhydrology\T4\runs\test_run_2208_100439\train_data
2024-08-22 10:04:39,402: img_log_dir: S:\hydrolab\home\Omri_Porat\PhD\Python\neuralhydrology-neuralhydrology-e4329c3\neuralhydrology\T4\runs\test_run_2208_100439\img_log
2024-08-22 10:04:39,622: ### Device cpu will be used for training
2024-08-22 10:04:39,625: Loading basin data into xarray data set.
2024-08-22 10:04:44,044: Create lookup table and convert to pytorch tensor
2024-08-22 10:04:46,325: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2024-08-22 10:04:49,423: Epoch 1 average loss: avg_loss: 0.78063, avg_tie_frequencies: 0.07265, avg_total_loss: 0.85327
2024-08-22 10:04:50,380: Epoch 2 average loss: avg_loss: 0.61567, avg_tie_frequencies: 0.05138, avg_total_loss: 0.66705
2024-08-22 10:04:51,463: Epoch 3 average loss: avg_loss: 0.48117, avg_tie_frequencies: 0.07523, avg_total_loss: 0.55640
2024-08-22 10:04:52,430: Epoch 4 average loss: avg_loss: 0.40673, avg_tie_frequencies: 0.07369, avg_total_loss: 0.48042
2024-08-22 10:04:53,410: Epoch 5 average loss: avg_loss: 0.35270, avg_tie_frequencies: 0.07559, avg_total_loss: 0.42828
2024-08-22 10:04:55,059: Epoch 5 average validation loss: 0.35485 -- Median validation metrics: avg_loss: 0.29061, avg_tie_frequencies: 0.06424, NSE_1H: 0.55686, NSE_1D: 0.52390
2024-08-22 10:04:56,019: Epoch 6 average loss: avg_loss: 0.30553, avg_tie_frequencies: 0.07131, avg_total_loss: 0.37684
2024-08-22 10:04:56,979: Epoch 7 average loss: avg_loss: 0.27157, avg_tie_frequencies: 0.07216, avg_total_loss: 0.34373
2024-08-22 10:04:57,928: Epoch 8 average loss: avg_loss: 0.26225, avg_tie_frequencies: 0.07050, avg_total_loss: 0.33275
2024-08-22 10:04:58,906: Epoch 9 average loss: avg_loss: 0.25189, avg_tie_frequencies: 0.07111, avg_total_loss: 0.32301
2024-08-22 10:04:59,889: Epoch 10 average loss: avg_loss: 0.23702, avg_tie_frequencies: 0.07006, avg_total_loss: 0.30709
2024-08-22 10:05:00,560: Epoch 10 average validation loss: 0.30546 -- Median validation metrics: avg_loss: 0.25885, avg_tie_frequencies: 0.04661, NSE_1H: 0.58810, NSE_1D: 0.60735
2024-08-22 10:05:01,499: Epoch 11 average loss: avg_loss: 0.22677, avg_tie_frequencies: 0.07071, avg_total_loss: 0.29747
2024-08-22 10:05:02,592: Epoch 12 average loss: avg_loss: 0.21699, avg_tie_frequencies: 0.06970, avg_total_loss: 0.28669
2024-08-22 10:05:03,580: Epoch 13 average loss: avg_loss: 0.21798, avg_tie_frequencies: 0.06564, avg_total_loss: 0.28362
2024-08-22 10:05:04,573: Epoch 14 average loss: avg_loss: 0.20835, avg_tie_frequencies: 0.06015, avg_total_loss: 0.26851
2024-08-22 10:05:05,527: Epoch 15 average loss: avg_loss: 0.19736, avg_tie_frequencies: 0.06382, avg_total_loss: 0.26117
2024-08-22 10:05:06,221: Epoch 15 average validation loss: 0.35824 -- Median validation metrics: avg_loss: 0.29401, avg_tie_frequencies: 0.06423, NSE_1H: 0.54050, NSE_1D: 0.65330
2024-08-22 10:05:07,132: Epoch 16 average loss: avg_loss: 0.19685, avg_tie_frequencies: 0.06713, avg_total_loss: 0.26398
2024-08-22 10:05:08,144: Epoch 17 average loss: avg_loss: 0.17949, avg_tie_frequencies: 0.06918, avg_total_loss: 0.24868
2024-08-22 10:05:09,151: Epoch 18 average loss: avg_loss: 0.18184, avg_tie_frequencies: 0.06895, avg_total_loss: 0.25079
2024-08-22 10:05:10,142: Epoch 19 average loss: avg_loss: 0.18442, avg_tie_frequencies: 0.05940, avg_total_loss: 0.24382
2024-08-22 10:05:11,127: Epoch 20 average loss: avg_loss: 0.16788, avg_tie_frequencies: 0.06058, avg_total_loss: 0.22846
2024-08-22 10:05:11,804: Epoch 20 average validation loss: 0.34087 -- Median validation metrics: avg_loss: 0.28490, avg_tie_frequencies: 0.05597, NSE_1H: 0.59055, NSE_1D: 0.66127
2024-08-22 10:05:12,750: Epoch 21 average loss: avg_loss: 0.15709, avg_tie_frequencies: 0.06148, avg_total_loss: 0.21857
2024-08-22 10:05:13,742: Epoch 22 average loss: avg_loss: 0.15555, avg_tie_frequencies: 0.06126, avg_total_loss: 0.21681
2024-08-22 10:05:14,732: Epoch 23 average loss: avg_loss: 0.15619, avg_tie_frequencies: 0.06180, avg_total_loss: 0.21799
2024-08-22 10:05:15,783: Epoch 24 average loss: avg_loss: 0.16172, avg_tie_frequencies: 0.06624, avg_total_loss: 0.22796
2024-08-22 10:05:16,784: Epoch 25 average loss: avg_loss: 0.15896, avg_tie_frequencies: 0.05993, avg_total_loss: 0.21889
2024-08-22 10:05:17,511: Epoch 25 average validation loss: 0.35756 -- Median validation metrics: avg_loss: 0.30008, avg_tie_frequencies: 0.05748, NSE_1H: 0.59024, NSE_1D: 0.66405
2024-08-22 10:05:18,473: Epoch 26 average loss: avg_loss: 0.15288, avg_tie_frequencies: 0.06381, avg_total_loss: 0.21669
2024-08-22 10:05:19,510: Epoch 27 average loss: avg_loss: 0.16088, avg_tie_frequencies: 0.07448, avg_total_loss: 0.23537
2024-08-22 10:05:20,546: Epoch 28 average loss: avg_loss: 0.15251, avg_tie_frequencies: 0.06541, avg_total_loss: 0.21793
2024-08-22 10:05:21,536: Epoch 29 average loss: avg_loss: 0.14988, avg_tie_frequencies: 0.06206, avg_total_loss: 0.21193
2024-08-22 10:05:21,571: Setting learning rate to 0.005
2024-08-22 10:05:22,640: Epoch 30 average loss: avg_loss: 0.14670, avg_tie_frequencies: 0.05950, avg_total_loss: 0.20621
2024-08-22 10:05:23,408: Epoch 30 average validation loss: 0.29057 -- Median validation metrics: avg_loss: 0.23079, avg_tie_frequencies: 0.05977, NSE_1H: 0.64313, NSE_1D: 0.69445
2024-08-22 10:05:24,355: Epoch 31 average loss: avg_loss: 0.15499, avg_tie_frequencies: 0.06679, avg_total_loss: 0.22177
2024-08-22 10:05:25,501: Epoch 32 average loss: avg_loss: 0.13904, avg_tie_frequencies: 0.05328, avg_total_loss: 0.19232
2024-08-22 10:05:26,577: Epoch 33 average loss: avg_loss: 0.14104, avg_tie_frequencies: 0.05626, avg_total_loss: 0.19730
2024-08-22 10:05:27,647: Epoch 34 average loss: avg_loss: 0.13346, avg_tie_frequencies: 0.05443, avg_total_loss: 0.18789
2024-08-22 10:05:28,728: Epoch 35 average loss: avg_loss: 0.13088, avg_tie_frequencies: 0.05691, avg_total_loss: 0.18779
2024-08-22 10:05:29,380: Epoch 35 average validation loss: 0.30201 -- Median validation metrics: avg_loss: 0.25184, avg_tie_frequencies: 0.05017, NSE_1H: 0.61473, NSE_1D: 0.71184
2024-08-22 10:05:30,365: Epoch 36 average loss: avg_loss: 0.13445, avg_tie_frequencies: 0.05813, avg_total_loss: 0.19258
2024-08-22 10:05:31,414: Epoch 37 average loss: avg_loss: 0.13461, avg_tie_frequencies: 0.05256, avg_total_loss: 0.18718
2024-08-22 10:05:32,453: Epoch 38 average loss: avg_loss: 0.12693, avg_tie_frequencies: 0.05424, avg_total_loss: 0.18117
2024-08-22 10:05:33,464: Epoch 39 average loss: avg_loss: 0.12616, avg_tie_frequencies: 0.04989, avg_total_loss: 0.17605
2024-08-22 10:05:33,499: Setting learning rate to 0.001
2024-08-22 10:05:34,513: Epoch 40 average loss: avg_loss: 0.12550, avg_tie_frequencies: 0.04440, avg_total_loss: 0.16990
2024-08-22 10:05:35,222: Epoch 40 average validation loss: 0.30519 -- Median validation metrics: avg_loss: 0.24019, avg_tie_frequencies: 0.06500, NSE_1H: 0.62675, NSE_1D: 0.70960
2024-08-22 10:05:36,205: Epoch 41 average loss: avg_loss: 0.11872, avg_tie_frequencies: 0.04763, avg_total_loss: 0.16636
2024-08-22 10:05:37,275: Epoch 42 average loss: avg_loss: 0.12119, avg_tie_frequencies: 0.05129, avg_total_loss: 0.17248
2024-08-22 10:05:38,365: Epoch 43 average loss: avg_loss: 0.11760, avg_tie_frequencies: 0.05067, avg_total_loss: 0.16828
2024-08-22 10:05:39,470: Epoch 44 average loss: avg_loss: 0.12690, avg_tie_frequencies: 0.05223, avg_total_loss: 0.17913
2024-08-22 10:05:40,536: Epoch 45 average loss: avg_loss: 0.11855, avg_tie_frequencies: 0.05307, avg_total_loss: 0.17162
2024-08-22 10:05:41,215: Epoch 45 average validation loss: 0.29765 -- Median validation metrics: avg_loss: 0.23110, avg_tie_frequencies: 0.06655, NSE_1H: 0.63559, NSE_1D: 0.71615
2024-08-22 10:05:42,230: Epoch 46 average loss: avg_loss: 0.11605, avg_tie_frequencies: 0.04810, avg_total_loss: 0.16415
2024-08-22 10:05:43,318: Epoch 47 average loss: avg_loss: 0.11495, avg_tie_frequencies: 0.04606, avg_total_loss: 0.16101
2024-08-22 10:05:44,423: Epoch 48 average loss: avg_loss: 0.11684, avg_tie_frequencies: 0.04848, avg_total_loss: 0.16532
2024-08-22 10:05:45,521: Epoch 49 average loss: avg_loss: 0.11564, avg_tie_frequencies: 0.05076, avg_total_loss: 0.16640
2024-08-22 10:05:46,625: Epoch 50 average loss: avg_loss: 0.11893, avg_tie_frequencies: 0.04914, avg_total_loss: 0.16807
2024-08-22 10:05:47,318: Epoch 50 average validation loss: 0.30531 -- Median validation metrics: avg_loss: 0.24184, avg_tie_frequencies: 0.06346, NSE_1H: 0.63564, NSE_1D: 0.69776
2024-08-22 10:14:54,944: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2024-08-22 10:14:55,753: Using the model weights from runs\test_run_2008_170854\model_epoch050.pt

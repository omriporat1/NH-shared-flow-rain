2025-02-10 23:52:05,270: Logging to /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/runs/Best_HPC_training_zscore_norm_ensemble_hidden_size256_batch_size512_learning_rate0001_1002_235205/output.log initialized.
2025-02-10 23:52:05,270: ### Folder structure created at /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/runs/Best_HPC_training_zscore_norm_ensemble_hidden_size256_batch_size512_learning_rate0001_1002_235205
2025-02-10 23:52:05,271: ### Run configurations for Best_HPC_training_zscore_norm_ensemble_hidden_size256_batch_size512_learning_rate0001
2025-02-10 23:52:05,271: autoregressive_inputs: ['Flow_m3_sec_zscore_norm_shift18']
2025-02-10 23:52:05,271: batch_size: 512
2025-02-10 23:52:05,271: clip_gradient_norm: 1
2025-02-10 23:52:05,271: clip_targets_to_zero: ['Flow_m3_sec_zscore_norm']
2025-02-10 23:52:05,271: data_dir: /sci/labs/efratmorin/omripo/PhD/Data/Caravan
2025-02-10 23:52:05,271: dataset: caravan
2025-02-10 23:52:05,271: device: cuda:0
2025-02-10 23:52:05,271: dynamic_inputs: ['Rain_gauge_1_zscore_norm', 'Rain_gauge_2_zscore_norm', 'Rain_gauge_3_zscore_norm']
2025-02-10 23:52:05,271: epochs: 15
2025-02-10 23:52:05,271: experiment_name: Best_HPC_training_zscore_norm_ensemble_hidden_size256_batch_size512_learning_rate0001
2025-02-10 23:52:05,271: forcings: ['il']
2025-02-10 23:52:05,271: head: regression
2025-02-10 23:52:05,271: hidden_size: 256
2025-02-10 23:52:05,271: initial_forget_bias: 3
2025-02-10 23:52:05,271: lagged_features: {'Flow_m3_sec_zscore_norm': [18], 'Rain_gauge_1_zscore_norm': [18], 'Rain_gauge_2_zscore_norm': [18], 'Rain_gauge_3_zscore_norm': [18]}
2025-02-10 23:52:05,271: learning_rate: 0.001
2025-02-10 23:52:05,271: log_interval: 5
2025-02-10 23:52:05,271: log_n_figures: 8
2025-02-10 23:52:05,271: log_tensorboard: True
2025-02-10 23:52:05,271: loss: MSE
2025-02-10 23:52:05,271: metrics: ['NSE']
2025-02-10 23:52:05,271: model: arlstm
2025-02-10 23:52:05,271: num_workers: 0
2025-02-10 23:52:05,271: optimizer: Adam
2025-02-10 23:52:05,271: output_activation: linear
2025-02-10 23:52:05,271: output_dropout: 0.4
2025-02-10 23:52:05,271: predict_last_n: 1
2025-02-10 23:52:05,271: save_weights_every: 1
2025-02-10 23:52:05,271: seq_length: 36
2025-02-10 23:52:05,271: target_variables: ['Flow_m3_sec_zscore_norm']
2025-02-10 23:52:05,271: test_basin_file: /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/LSTM_shared_8basins.txt
2025-02-10 23:52:05,272: test_end_date: 2018-05-28 00:00:00
2025-02-10 23:52:05,272: test_start_date: 2017-10-01 00:00:00
2025-02-10 23:52:05,272: train_basin_file: /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/LSTM_shared_8basins.txt
2025-02-10 23:52:05,272: train_end_date: [Timestamp('2011-05-30 00:00:00'), Timestamp('2012-05-30 00:00:00'), Timestamp('2013-05-30 00:00:00'), Timestamp('2014-05-30 00:00:00'), Timestamp('2015-05-30 00:00:00')]
2025-02-10 23:52:05,272: train_start_date: [Timestamp('2010-10-07 00:00:00'), Timestamp('2011-10-07 00:00:00'), Timestamp('2012-10-07 00:00:00'), Timestamp('2013-10-07 00:00:00'), Timestamp('2014-10-07 00:00:00')]
2025-02-10 23:52:05,272: use_basin_id_encoding: False
2025-02-10 23:52:05,272: validate_every: 1
2025-02-10 23:52:05,272: validate_n_random_basins: 0
2025-02-10 23:52:05,272: validation_basin_file: /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/LSTM_shared_8basins.txt
2025-02-10 23:52:05,272: validation_end_date: 2017-05-30 00:00:00
2025-02-10 23:52:05,272: validation_start_date: 2015-10-01 00:00:00
2025-02-10 23:52:05,272: number_of_basins: 8
2025-02-10 23:52:05,272: run_dir: /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/runs/Best_HPC_training_zscore_norm_ensemble_hidden_size256_batch_size512_learning_rate0001_1002_235205
2025-02-10 23:52:05,273: train_dir: /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/runs/Best_HPC_training_zscore_norm_ensemble_hidden_size256_batch_size512_learning_rate0001_1002_235205/train_data
2025-02-10 23:52:05,273: img_log_dir: /sci/labs/efratmorin/omripo/PhD/NH-shared-flow-rain/nhWrap/neuralhydrology/trial/runs/Best_HPC_training_zscore_norm_ensemble_hidden_size256_batch_size512_learning_rate0001_1002_235205/img_log
2025-02-10 23:52:05,421: ### Device cuda:0 will be used for training
2025-02-10 23:52:05,422: Loading basin data into xarray data set.
2025-02-10 23:52:19,907: Create lookup table and convert to pytorch tensor
2025-02-10 23:53:04,073: Validation set to validate every 1 epoch(s), but 'validate_n_random_basins' not set or set to zero. Will validate on the entire validation set.
2025-02-10 23:55:15,532: Epoch 1 average loss: avg_loss: 0.13528, avg_total_loss: 0.13528
2025-02-10 23:56:16,915: Epoch 1 average validation loss: 0.01767 -- Median validation metrics: avg_loss: 0.01767, NSE: 0.36805
2025-02-10 23:58:21,795: Epoch 2 average loss: avg_loss: 0.12527, avg_total_loss: 0.12527
2025-02-10 23:58:46,584: Epoch 2 average validation loss: 0.01490 -- Median validation metrics: avg_loss: 0.01490, NSE: 0.39350
2025-02-11 00:00:56,473: Epoch 3 average loss: avg_loss: 0.09762, avg_total_loss: 0.09762
2025-02-11 00:01:21,535: Epoch 3 average validation loss: 0.01517 -- Median validation metrics: avg_loss: 0.01517, NSE: 0.39322
2025-02-11 00:03:30,081: Epoch 4 average loss: avg_loss: 0.08415, avg_total_loss: 0.08415
2025-02-11 00:03:55,776: Epoch 4 average validation loss: 0.01638 -- Median validation metrics: avg_loss: 0.01638, NSE: 0.36158
2025-02-11 00:06:41,082: Epoch 5 average loss: avg_loss: 0.07103, avg_total_loss: 0.07103
2025-02-11 00:07:09,564: Epoch 5 average validation loss: 0.01530 -- Median validation metrics: avg_loss: 0.01530, NSE: 0.35733
2025-02-11 00:09:22,044: Epoch 6 average loss: avg_loss: 0.06042, avg_total_loss: 0.06042
2025-02-11 00:09:47,893: Epoch 6 average validation loss: 0.01854 -- Median validation metrics: avg_loss: 0.01854, NSE: 0.31525
2025-02-11 00:11:59,817: Epoch 7 average loss: avg_loss: 0.05025, avg_total_loss: 0.05025
2025-02-11 00:12:25,632: Epoch 7 average validation loss: 0.01665 -- Median validation metrics: avg_loss: 0.01665, NSE: 0.34640
2025-02-11 00:14:40,086: Epoch 8 average loss: avg_loss: 0.04473, avg_total_loss: 0.04473
2025-02-11 00:15:06,349: Epoch 8 average validation loss: 0.01620 -- Median validation metrics: avg_loss: 0.01620, NSE: 0.37277
2025-02-11 00:17:21,697: Epoch 9 average loss: avg_loss: 0.04068, avg_total_loss: 0.04068
2025-02-11 00:17:47,379: Epoch 9 average validation loss: 0.01905 -- Median validation metrics: avg_loss: 0.01905, NSE: 0.36013
2025-02-11 00:20:00,201: Epoch 10 average loss: avg_loss: 0.03449, avg_total_loss: 0.03449
2025-02-11 00:20:26,122: Epoch 10 average validation loss: 0.01730 -- Median validation metrics: avg_loss: 0.01730, NSE: 0.29449
2025-02-11 00:22:59,593: Epoch 11 average loss: avg_loss: 0.03163, avg_total_loss: 0.03163
2025-02-11 00:23:26,733: Epoch 11 average validation loss: 0.01691 -- Median validation metrics: avg_loss: 0.01691, NSE: 0.37045
2025-02-11 00:25:44,217: Epoch 12 average loss: avg_loss: 0.02795, avg_total_loss: 0.02795
2025-02-11 00:26:10,650: Epoch 12 average validation loss: 0.01951 -- Median validation metrics: avg_loss: 0.01951, NSE: 0.33502
2025-02-11 00:28:23,320: Epoch 13 average loss: avg_loss: 0.02816, avg_total_loss: 0.02816
2025-02-11 00:28:49,186: Epoch 13 average validation loss: 0.02180 -- Median validation metrics: avg_loss: 0.02180, NSE: 0.17425
2025-02-11 00:31:01,107: Epoch 14 average loss: avg_loss: 0.02451, avg_total_loss: 0.02451
2025-02-11 00:31:26,736: Epoch 14 average validation loss: 0.02104 -- Median validation metrics: avg_loss: 0.02104, NSE: 0.32089
2025-02-11 00:33:38,003: Epoch 15 average loss: avg_loss: 0.02489, avg_total_loss: 0.02489
2025-02-11 00:34:04,351: Epoch 15 average validation loss: 0.01835 -- Median validation metrics: avg_loss: 0.01835, NSE: 0.31967
